                             apptg/netlify/functions:
///////////////////////////////////////////////////////////////////////////
gifts.js:
////////////////////
exports.handler = async (event, context) => {
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    const gifts = [
        {
            id: 'gift_1',
            emoji: 'ü•É',
            name: '50 –≥—Ä–∞–º–º',
            description: '50 –≥—Ä–∞–º–º —Å–∞–º–æ–≥–æ–Ω–∞',
            price: 5,
            currency: 'coins',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_2',
            emoji: 'üö¨',
            name: '–ú–∞—Ä–ª—å–±–æ—Ä–æ',
            description: '–ü–∞—á–∫–∞ —Å–∏–≥–∞—Ä–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥—ã–º–Ω–æ–π –∑–∞–≤–µ—Å—ã',
            price: 10,
            currency: 'stars',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_3',
            emoji: 'üí™',
            name: '–ü—Ä–æ—Ç–µ–∏–Ω',
            description: '–ë–∞–Ω–∫–∞ –ø—Ä–æ—Ç–µ–∏–Ω–∞ –¥–ª—è –Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏—è –º—ã—à—Ü',
            price: 15,
            currency: 'stars',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_4',
            emoji: 'üíâ',
            name: '–¢—Ä–µ–Ω–±–æ–ª–æ–Ω –∞—Ü–µ—Ç–∞—Ç',
            description: '–ê–º–ø—É–ª–∞ –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –∫–∞—á–∫–æ–≤',
            price: 20,
            currency: 'coins',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_5',
            emoji: 'üî•',
            name: '–ó–∞–∂–∏–≥–∞–ª–∫–∞',
            description: '–ó–∞–∂–∏–≥–∞–ª–∫–∞ –¥–ª—è –ø–æ–¥–∂–∏–≥–∞–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π',
            price: 8,
            currency: 'stars',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_6',
            emoji: 'üß™',
            name: '–ö–æ–ª–±–∞ —Ö–∏–º–∏–∫–∞',
            description: '–ü—É—Å—Ç–∞—è –∫–æ–ª–±–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤',
            price: 12,
            currency: 'stars',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        },
        {
            id: 'gift_7',
            emoji: 'üß´',
            name: '–ü—Ä–æ–±–∏—Ä–∫–∞',
            description: '–ü—Ä–æ–±–∏—Ä–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—â–µ—Å—Ç–≤',
            price: 7,
            currency: 'stars',
            category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
        }
    ];

    return {
        statusCode: 200,
        headers,
        body: JSON.stringify({ success: true, gifts })
    };
};
////////////////////////////////////////////



user-balance.js:
////////////////////////////////////////////////
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const supabase = createClient(supabaseUrl, supabaseKey);

exports.handler = async (event, context) => {
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    try {
        if (event.httpMethod !== 'POST') {
            return {
                statusCode: 405,
                headers,
                body: JSON.stringify({ error: 'Method not allowed' })
            };
        }

        const { userId } = event.pathParameters || {};
        const body = JSON.parse(event.body || '{}');
        const { stars = 0, coins = 0 } = body;

        if (!userId) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: 'User ID is required' 
                })
            };
        }

        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const { data: user, error: userError } = await supabase
            .from('users')
            .select('*')
            .eq('id', userId)
            .single();

        if (userError) throw userError;

        if (!user) {
            return {
                statusCode: 404,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' 
                })
            };
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
        const newBalance = Math.max(0, user.balance + stars);
        const newCoins = Math.max(0, user.coins + coins);

        const { data: updatedUser, error: updateError } = await supabase
            .from('users')
            .update({
                balance: newBalance,
                coins: newCoins,
                updated_at: new Date().toISOString()
            })
            .eq('id', userId)
            .select()
            .single();

        if (updateError) throw updateError;

        // –õ–æ–≥–∏—Ä—É–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        if (stars !== 0) {
            await supabase.from('transactions').insert([{
                user_id: userId,
                type: stars > 0 ? 'deposit' : 'withdraw',
                amount: Math.abs(stars),
                currency: 'stars',
                status: 'completed'
            }]);
        }

        if (coins !== 0) {
            await supabase.from('transactions').insert([{
                user_id: userId,
                type: coins > 0 ? 'deposit' : 'withdraw',
                amount: Math.abs(coins),
                currency: 'coins',
                status: 'completed'
            }]);
        }

        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ success: true, user: updatedUser })
        };

    } catch (error) {
        console.error('Error:', error);
        
        return {
            statusCode: 500,
            headers,
            body: JSON.stringify({ 
                success: false, 
                error: error.message 
            })
        };
    }
};
//////////////////////////////////////////////////////



user-get.js:
////////////////////////////////////////
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const supabase = createClient(supabaseUrl, supabaseKey);

exports.handler = async (event, context) => {
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    try {
        const { telegramId } = event.pathParameters || {};

        if (!telegramId) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: 'Telegram ID is required' 
                })
            };
        }

        const { data: user, error } = await supabase
            .from('users')
            .select('*')
            .eq('telegram_id', telegramId)
            .single();

        if (error) {
            if (error.code === 'PGRST116') {
                return {
                    statusCode: 404,
                    headers,
                    body: JSON.stringify({ 
                        success: false, 
                        error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' 
                    })
                };
            }
            throw error;
        }

        if (user) {
            // –ü–æ–ª—É—á–∞–µ–º –ø–æ–¥–∞—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const { data: gifts } = await supabase
                .from('gifts')
                .select('*')
                .eq('user_id', user.id);
            
            user.gifts = gifts || [];

            return {
                statusCode: 200,
                headers,
                body: JSON.stringify({ success: true, user })
            };
        }

    } catch (error) {
        console.error('Error:', error);
        
        return {
            statusCode: 500,
            headers,
            body: JSON.stringify({ 
                success: false, 
                error: error.message 
            })
        };
    }
};
//////////////////////////////////////////




user-gifts.js:
////////////////////////////////////////////////////////////
// netlify/functions/user-gifts.js
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const supabase = createClient(supabaseUrl, supabaseKey);

exports.handler = async (event, context) => {
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    try {
        if (event.httpMethod !== 'POST') {
            return {
                statusCode: 405,
                headers,
                body: JSON.stringify({ error: 'Method not allowed' })
            };
        }

        const { userId } = event.pathParameters || {};
        const body = JSON.parse(event.body || '{}');
        const { gift_id } = body;

        if (!userId || !gift_id) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: 'User ID and Gift ID are required' 
                })
            };
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∫—É–ø–ª–µ–Ω –ª–∏ —É–∂–µ –ø–æ–¥–∞—Ä–æ–∫
        const { data: existingGift } = await supabase
            .from('gifts')
            .select('*')
            .eq('user_id', userId)
            .eq('gift_id', gift_id)
            .single();

        if (existingGift) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: '–ü–æ–¥–∞—Ä–æ–∫ —É–∂–µ –∫—É–ø–ª–µ–Ω' 
                })
            };
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–∞—Ä–æ–∫
        const { data: gift, error: giftError } = await supabase
            .from('gifts')
            .insert([{
                user_id: userId,
                gift_id: gift_id,
                purchased_at: new Date().toISOString()
            }])
            .select()
            .single();

        if (giftError) throw giftError;

        // –û–±–Ω–æ–≤–ª—è–µ–º updated_at —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        await supabase
            .from('users')
            .update({ updated_at: new Date().toISOString() })
            .eq('id', userId);

        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ success: true, gift })
        };

    } catch (error) {
        console.error('Error:', error);
        
        return {
            statusCode: 500,
            headers,
            body: JSON.stringify({ 
                success: false, 
                error: error.message 
            })
        };
    }
};
////////////////////////////////////////////////////////////




user-init.js:
//////////////////////////////////////////////////////////////
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const supabase = createClient(supabaseUrl, supabaseKey);

exports.handler = async (event, context) => {
    // –†–∞–∑—Ä–µ—à–∞–µ–º CORS
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ preflight –∑–∞–ø—Ä–æ—Å–æ–≤
    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    try {
        if (event.httpMethod !== 'POST') {
            return {
                statusCode: 405,
                headers,
                body: JSON.stringify({ error: 'Method not allowed' })
            };
        }

        const body = JSON.parse(event.body || '{}');
        const { id, username, first_name, last_name, photo_url } = body;

        if (!id) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: 'Telegram ID is required' 
                })
            };
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        const { data: existingUser, error: checkError } = await supabase
            .from('users')
            .select('*')
            .eq('telegram_id', id)
            .single();

        if (existingUser) {
            return {
                statusCode: 200,
                headers,
                body: JSON.stringify({ 
                    success: true, 
                    user: existingUser,
                    exists: true 
                })
            };
        }

        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const newUser = {
            telegram_id: id,
            username: username || '–ì–æ—Å—Ç—å',
            first_name: first_name || '',
            last_name: last_name || '',
            photo_url: photo_url || '',
            balance: 100,
            coins: 0,
            spin_count: 0,
            win_count: 0,
            jackpots: 0,
            join_date: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };

        const { data: createdUser, error: createError } = await supabase
            .from('users')
            .insert([newUser])
            .select()
            .single();

        if (createError) {
            throw createError;
        }

        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ 
                success: true, 
                user: createdUser,
                exists: false 
            })
        };

    } catch (error) {
        console.error('Error:', error);
        
        return {
            statusCode: 500,
            headers,
            body: JSON.stringify({ 
                success: false, 
                error: error.message,
                code: error.code 
            })
        };
    }
};
/////////////////////////////////////////////////////////////




user-stats.js:
///////////////////////////////////////////////////////////////////
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const supabase = createClient(supabaseUrl, supabaseKey);

exports.handler = async (event, context) => {
    const headers = {
        'Access-Control-Allow-Origin': '*',
        'Access-Control-Allow-Headers': 'Content-Type',
        'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',
        'Content-Type': 'application/json'
    };

    if (event.httpMethod === 'OPTIONS') {
        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ message: 'CORS preflight' })
        };
    }

    try {
        if (event.httpMethod !== 'POST') {
            return {
                statusCode: 405,
                headers,
                body: JSON.stringify({ error: 'Method not allowed' })
            };
        }

        const { userId } = event.pathParameters || {};
        const body = JSON.parse(event.body || '{}');
        const { spin_count = 0, win_count = 0, jackpots = 0 } = body;

        if (!userId) {
            return {
                statusCode: 400,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: 'User ID is required' 
                })
            };
        }

        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const { data: user, error: userError } = await supabase
            .from('users')
            .select('*')
            .eq('id', userId)
            .single();

        if (userError) throw userError;

        if (!user) {
            return {
                statusCode: 404,
                headers,
                body: JSON.stringify({ 
                    success: false, 
                    error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' 
                })
            };
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        const { data: updatedUser, error: updateError } = await supabase
            .from('users')
            .update({
                spin_count: user.spin_count + spin_count,
                win_count: user.win_count + win_count,
                jackpots: user.jackpots + jackpots,
                updated_at: new Date().toISOString()
            })
            .eq('id', userId)
            .select()
            .single();

        if (updateError) throw updateError;

        return {
            statusCode: 200,
            headers,
            body: JSON.stringify({ success: true, user: updatedUser })
        };

    } catch (error) {
        console.error('Error:', error);
        
        return {
            statusCode: 500,
            headers,
            body: JSON.stringify({ 
                success: false, 
                error: error.message 
            })
        };
    }
};
//////////////////////////////////////////////////////////////////








                             apptg/public:
    ///////////////////////////////////////////////////////////////////////////////////

    api.js:
/////////////////////////////////////////////////////////////
// api.js - –¥–ª—è Netlify Functions

// –ë–∞–∑–æ–≤—ã–π URL API (Netlify –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞—Ç—å)
const API_BASE_URL = '/api';

// –ö—ç—à –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
let userCache = null;

class Api {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    static async initUser(userData) {
        try {
            const response = await fetch(`${API_BASE_URL}/user-init`, {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify(userData)
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.success) {
                userCache = data.user;
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –∫–∞–∫ fallback
                localStorage.setItem('userData', JSON.stringify(data.user));
            }
            
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
            // Fallback –Ω–∞ localStorage
            return this.createLocalUser(userData);
        }
    }
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ Telegram ID
    static async getUser(telegramId) {
        try {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
            if (userCache && userCache.telegram_id == telegramId) {
                return { success: true, user: userCache };
            }
            
            const response = await fetch(`${API_BASE_URL}/user-get/${telegramId}`, {
                headers: { 'Accept': 'application/json' }
            });
            
            if (!response.ok) {
                if (response.status === 404) {
                    return { success: false, error: '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω' };
                }
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.success) {
                userCache = data.user;
                localStorage.setItem('userData', JSON.stringify(data.user));
            }
            
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
            // Fallback –Ω–∞ localStorage
            const localData = localStorage.getItem('userData');
            if (localData) {
                userCache = JSON.parse(localData);
                return { success: true, user: userCache };
            }
            return { success: false, error: '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö' };
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
    static async updateBalance(userId, starsDelta = 0, coinsDelta = 0) {
        try {
            const response = await fetch(`${API_BASE_URL}/user-balance/${userId}`, {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({ stars: starsDelta, coins: coinsDelta })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.success && userCache && userCache.id === userId) {
                userCache.balance += starsDelta;
                userCache.coins += coinsDelta;
                userCache.updated_at = new Date().toISOString();
                localStorage.setItem('userData', JSON.stringify(userCache));
            }
            
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
            // Fallback –Ω–∞ localStorage
            if (userCache && userCache.id === userId) {
                userCache.balance += starsDelta;
                userCache.coins += coinsDelta;
                localStorage.setItem('userData', JSON.stringify(userCache));
                return { success: true };
            }
            return { success: false, error: '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è' };
        }
    }
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    static async updateStats(userId, spinCount = 0, winCount = 0, jackpots = 0) {
        try {
            const response = await fetch(`${API_BASE_URL}/user-stats/${userId}`, {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({ 
                    spin_count: spinCount, 
                    win_count: winCount, 
                    jackpots: jackpots 
                })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.success && userCache && userCache.id === userId) {
                userCache.spin_count += spinCount;
                userCache.win_count += winCount;
                userCache.jackpots += jackpots;
                userCache.updated_at = new Date().toISOString();
                localStorage.setItem('userData', JSON.stringify(userCache));
            }
            
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', error);
            // Fallback –Ω–∞ localStorage
            if (userCache && userCache.id === userId) {
                userCache.spin_count += spinCount;
                userCache.win_count += winCount;
                userCache.jackpots += jackpots;
                localStorage.setItem('userData', JSON.stringify(userCache));
                return { success: true };
            }
            return { success: false, error: '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è' };
        }
    }
    
    // –ü–æ–∫—É–ø–∫–∞ –ø–æ–¥–∞—Ä–∫–∞ (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é user-gifts.js –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)
    static async purchaseGift(userId, giftId) {
        try {
            const response = await fetch(`${API_BASE_URL}/user-gifts/${userId}`, {
                method: 'POST',
                headers: { 
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                body: JSON.stringify({ gift_id: giftId })
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            const data = await response.json();
            
            if (data.success && userCache && userCache.id === userId) {
                if (!userCache.gifts) userCache.gifts = [];
                userCache.gifts.push({
                    id: giftId,
                    purchased_at: new Date().toISOString()
                });
                localStorage.setItem('userData', JSON.stringify(userCache));
            }
            
            return data;
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏ –ø–æ–¥–∞—Ä–∫–∞:', error);
            // Fallback –Ω–∞ localStorage
            if (userCache && userCache.id === userId) {
                if (!userCache.gifts) userCache.gifts = [];
                userCache.gifts.push({
                    id: giftId,
                    purchased_at: new Date().toISOString()
                });
                localStorage.setItem('userData', JSON.stringify(userCache));
                return { success: true };
            }
            return { success: false, error: '–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏' };
        }
    }
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–¥–∞—Ä–∫–æ–≤
    static async getGifts() {
        try {
            const response = await fetch(`${API_BASE_URL}/gifts`, {
                headers: { 'Accept': 'application/json' }
            });
            
            if (!response.ok) {
                throw new Error(`HTTP ${response.status}: ${response.statusText}`);
            }
            
            return await response.json();
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤:', error);
            // –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –∫–∞–∫ fallback
            const gifts = [
                {
                    id: 'gift_1',
                    emoji: 'ü•É',
                    name: '50 –≥—Ä–∞–º–º',
                    description: '50 –≥—Ä–∞–º–º —Å–∞–º–æ–≥–æ–Ω–∞',
                    price: 5,
                    currency: 'coins',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_2',
                    emoji: 'üö¨',
                    name: '–ú–∞—Ä–ª—å–±–æ—Ä–æ',
                    description: '–ü–∞—á–∫–∞ —Å–∏–≥–∞—Ä–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥—ã–º–Ω–æ–π –∑–∞–≤–µ—Å—ã',
                    price: 10,
                    currency: 'stars',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_3',
                    emoji: 'üí™',
                    name: '–ü—Ä–æ—Ç–µ–∏–Ω',
                    description: '–ë–∞–Ω–∫–∞ –ø—Ä–æ—Ç–µ–∏–Ω–∞ –¥–ª—è –Ω–∞—Ä–∞—â–∏–≤–∞–Ω–∏—è –º—ã—à—Ü',
                    price: 15,
                    currency: 'stars',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_4',
                    emoji: 'üíâ',
                    name: '–¢—Ä–µ–Ω–±–æ–ª–æ–Ω –∞—Ü–µ—Ç–∞—Ç',
                    description: '–ê–º–ø—É–ª–∞ –¥–ª—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –∫–∞—á–∫–æ–≤',
                    price: 20,
                    currency: 'coins',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_5',
                    emoji: 'üî•',
                    name: '–ó–∞–∂–∏–≥–∞–ª–∫–∞',
                    description: '–ó–∞–∂–∏–≥–∞–ª–∫–∞ –¥–ª—è –ø–æ–¥–∂–∏–≥–∞–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏–π',
                    price: 8,
                    currency: 'stars',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_6',
                    emoji: 'üß™',
                    name: '–ö–æ–ª–±–∞ —Ö–∏–º–∏–∫–∞',
                    description: '–ü—É—Å—Ç–∞—è –∫–æ–ª–±–∞ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤',
                    price: 12,
                    currency: 'stars',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                },
                {
                    id: 'gift_7',
                    emoji: 'üß´',
                    name: '–ü—Ä–æ–±–∏—Ä–∫–∞',
                    description: '–ü—Ä–æ–±–∏—Ä–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–µ—â–µ—Å—Ç–≤',
                    price: 7,
                    currency: 'stars',
                    category: '–ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞'
                }
            ];
            return { success: true, gifts };
        }
    }
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    static getCurrentUser() {
        if (userCache) {
            return userCache;
        }
        
        const localData = localStorage.getItem('userData');
        if (localData) {
            userCache = JSON.parse(localData);
            return userCache;
        }
        
        return null;
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (fallback)
    static createLocalUser(userData) {
        const userId = userData?.id || `guest_${Date.now()}`;
        const user = {
            id: userId,
            telegram_id: userId,
            username: userData?.username || '–ì–æ—Å—Ç—å',
            first_name: userData?.first_name || '',
            last_name: userData?.last_name || '',
            photo_url: userData?.photo_url || '',
            balance: 100,
            coins: 0,
            spin_count: 0,
            win_count: 0,
            jackpots: 0,
            gifts: [],
            join_date: new Date().toISOString(),
            updated_at: new Date().toISOString()
        };
        
        localStorage.setItem('userData', JSON.stringify(user));
        userCache = user;
        
        return { success: true, user };
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
document.addEventListener('DOMContentLoaded', () => {
    try {
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = window.Telegram.WebApp;
            tg.ready();
            tg.expand();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const initUser = async () => {
                const user = tg.initDataUnsafe?.user;
                if (user) {
                    await Api.initUser({
                        id: user.id.toString(),
                        username: user.username,
                        first_name: user.first_name,
                        last_name: user.last_name,
                        photo_url: user.photo_url
                    });
                }
            };
            
            initUser();
        }
    } catch (error) {
        console.log('Telegram Web App –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
    }
});
///////////////////////////////////////////////////////////////////




app.js:
////////////////////////////////////////////////////////////////////////////////////////
// app.js - –° –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
const CONFIG = {
    symbols: ['üçí', 'üçã', 'üçä', 'üçâ', '‚≠ê', 'üîî', 'üíé', 'üé∞'],
    probabilities: {
        'üçí': 0.18,
        'üçã': 0.16,
        'üçä': 0.14,
        'üçâ': 0.12,
        '‚≠ê': 0.10,
        'üîî': 0.10,
        'üíé': 0.10,
        'üé∞': 0.10
    },
    payouts: {
        'üé∞üé∞üé∞': 1000,
        'üíéüíéüíé': 500,
        'üîîüîîüîî': 200,
        '‚≠ê‚≠ê‚≠ê': 100,
        'üçâüçâüçâ': 50,
        'üçäüçäüçä': 30,
        'üçãüçãüçã': 20,
        'üçíüçíüçí': 10,
        // –î–æ–±–∞–≤–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à–∏ –∑–∞ 2 —Å–∏–º–≤–æ–ª–∞
        'üé∞üé∞': 50,
        'üíéüíé': 40,
        'üîîüîî': 30,
        '‚≠ê‚≠ê': 25,
        'üçâüçâ': 20,
        'üçäüçä': 15,
        'üçãüçã': 10,
        'üçíüçí': 5
    }
};

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
const state = {
    balance: 100,
    coins: 0,
    jackpots: 0,
    isSpinning: false,
    lastWin: 0,
    spinCount: 0,
    winCount: 0,
    currentSymbols: ['üçí', 'üçí', 'üçí']
};

// DOM —ç–ª–µ–º–µ–Ω—Ç—ã
const elements = {
    balance: document.getElementById('balance'),
    coins: document.getElementById('coins'),
    jackpots: document.getElementById('jackpots'),
    spinButton: document.getElementById('spinButton'),
    winAmount: document.getElementById('winAmount'),
    winDisplay: document.getElementById('winDisplay'),
    reel1: document.getElementById('reel1'),
    reel2: document.getElementById('reel2'),
    reel3: document.getElementById('reel3'),
    notification: document.getElementById('notification'),
    notificationText: document.getElementById('notificationText'),
    totalSpins: document.getElementById('totalSpins'),
    totalWins: document.getElementById('totalWins'),
    winRate: document.getElementById('winRate')
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
function init() {
    console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã...');
    loadGameState();
    updateUI();
    initializeReels();
    setupEventListeners();
    loadUserData();
}

// –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ localStorage
function loadGameState() {
    try {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –≤ localStorage
        const savedState = localStorage.getItem('gameState');
        if (savedState) {
            const parsed = JSON.parse(savedState);
            Object.assign(state, parsed);
        }
        
        // –î–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—Ç–∞—Ä—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
        const savedBalance = localStorage.getItem('slotsBalance');
        const savedCoins = localStorage.getItem('slotsCoins');
        const savedJackpots = localStorage.getItem('slotsJackpots');
        const savedSpinCount = localStorage.getItem('slotsSpinCount');
        const savedWinCount = localStorage.getItem('slotsWinCount');
        
        if (savedBalance !== null) state.balance = parseInt(savedBalance) || 100;
        if (savedCoins !== null) state.coins = parseInt(savedCoins) || 0;
        if (savedJackpots !== null) state.jackpots = parseInt(savedJackpots) || 0;
        if (savedSpinCount !== null) state.spinCount = parseInt(savedSpinCount) || 0;
        if (savedWinCount !== null) state.winCount = parseInt(savedWinCount) || 0;
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage:', error);
    }
}

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ localStorage
function saveGameState() {
    try {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        localStorage.setItem('gameState', JSON.stringify(state));
        
        // –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
        localStorage.setItem('slotsBalance', state.balance.toString());
        localStorage.setItem('slotsCoins', state.coins.toString());
        localStorage.setItem('slotsJackpots', state.jackpots.toString());
        localStorage.setItem('slotsSpinCount', state.spinCount.toString());
        localStorage.setItem('slotsWinCount', state.winCount.toString());
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', error);
    }
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ API
async function loadUserData() {
    try {
        if (typeof Api !== 'undefined' && Api.getCurrentUser) {
            const user = Api.getCurrentUser();
            if (user) {
                console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑ API:', user);
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                const shouldUpdateLocal = (
                    state.spinCount !== (user.spin_count || 0) ||
                    state.winCount !== (user.win_count || 0) ||
                    state.jackpots !== (user.jackpots || 0)
                );
                
                if (shouldUpdateLocal) {
                    state.spinCount = user.spin_count || state.spinCount;
                    state.winCount = user.win_count || state.winCount;
                    state.jackpots = user.jackpots || state.jackpots;
                    saveGameState();
                }
                
                updateUI();
            }
        }
    } catch (error) {
        console.log('API –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞—Ä–∞–±–∞–Ω–æ–≤
function initializeReels() {
    const reels = [elements.reel1, elements.reel2, elements.reel3];
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã
    if (!reels[0] || !reels[1] || !reels[2]) {
        console.error('–≠–ª–µ–º–µ–Ω—Ç—ã –±–∞—Ä–∞–±–∞–Ω–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!');
        return;
    }
    
    reels.forEach((reel, index) => {
        // –û—á–∏—â–∞–µ–º –±–∞—Ä–∞–±–∞–Ω
        reel.innerHTML = '';
        
        // –°–æ–∑–¥–∞–µ–º 3 –∫–æ–ø–∏–∏ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
        for (let copy = 0; copy < 3; copy++) {
            CONFIG.symbols.forEach(symbol => {
                const item = document.createElement('div');
                item.className = 'slot-item';
                item.textContent = symbol;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è —Ü–≤–µ—Ç–∞
                if (symbol === 'üçí') item.classList.add('cherry');
                else if (symbol === 'üçã') item.classList.add('lemon');
                else if (symbol === 'üçä') item.classList.add('orange');
                else if (symbol === 'üçâ') item.classList.add('watermelon');
                else if (symbol === '‚≠ê') item.classList.add('star');
                else if (symbol === 'üîî') item.classList.add('bell');
                else if (symbol === 'üíé') item.classList.add('diamond');
                else if (symbol === 'üé∞') item.classList.add('seven');
                
                reel.appendChild(item);
            });
        }
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
        setReelPosition(reel, index);
    });
}

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ –±–∞—Ä–∞–±–∞–Ω–∞
function setReelPosition(reel, reelIndex) {
    const symbol = state.currentSymbols[reelIndex] || 'üçí';
    const symbolIndex = CONFIG.symbols.indexOf(symbol);
    if (symbolIndex === -1) return;
    
    const itemHeight = 60;
    const reelHeight = 180;
    const offset = Math.floor((reelHeight / itemHeight) / 2) * itemHeight;
    const position = -(symbolIndex * itemHeight) + offset;
    
    reel.style.transform = `translateY(${position}px)`;
    reel.style.transition = 'none';
    reel.offsetHeight;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
function updateUI() {
    if (elements.balance) elements.balance.textContent = state.balance;
    if (elements.coins) elements.coins.textContent = state.coins;
    if (elements.jackpots) elements.jackpots.textContent = state.jackpots;
    if (elements.winAmount) elements.winAmount.textContent = state.lastWin;
    if (elements.totalSpins) elements.totalSpins.textContent = state.spinCount;
    if (elements.totalWins) elements.totalWins.textContent = state.winCount;
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥
    if (elements.winRate) {
        const winRate = state.spinCount > 0 ? 
            Math.round((state.winCount / state.spinCount) * 100) : 0;
        elements.winRate.textContent = `${winRate}%`;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –¥–∏—Å–ø–ª–µ–π –≤—ã–∏–≥—Ä—ã—à–∞
    if (elements.winDisplay) {
        elements.winDisplay.style.display = state.lastWin > 0 ? 'flex' : 'none';
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
    if (elements.spinButton) {
        elements.spinButton.disabled = state.isSpinning || state.balance <= 0;
    }
}

// –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
function showNotification(message, duration = 3000) {
    if (!elements.notification || !elements.notificationText) return;
    
    elements.notificationText.textContent = message;
    elements.notification.classList.add('show');
    
    setTimeout(() => {
        elements.notification.classList.remove('show');
    }, duration);
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
function getRandomSymbol() {
    const rand = Math.random();
    let cumulative = 0;
    
    for (const [symbol, probability] of Object.entries(CONFIG.probabilities)) {
        cumulative += probability;
        if (rand <= cumulative) {
            return symbol;
        }
    }
    
    return 'üçí';
}

// –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è –±–∞—Ä–∞–±–∞–Ω–∞
function spinReel(reel, finalSymbol, delay = 0) {
    return new Promise(resolve => {
        setTimeout(() => {
            const duration = 2000;
            const itemHeight = 60;
            const symbolIndex = CONFIG.symbols.indexOf(finalSymbol);
            
            const reelHeight = 180;
            const offset = Math.floor((reelHeight / itemHeight) / 2) * itemHeight;
            const targetY = -(symbolIndex * itemHeight) + offset;
            
            const currentTransform = reel.style.transform || 'translateY(0px)';
            const match = currentTransform.match(/translateY\(([-\d]+)px\)/);
            const currentY = match ? parseInt(match[1]) : 0;
            
            const extraSpins = 5;
            const extraDistance = extraSpins * CONFIG.symbols.length * itemHeight;
            
            reel.style.transition = 'none';
            reel.style.transform = `translateY(${currentY - extraDistance}px)`;
            reel.offsetHeight;
            
            reel.style.transition = `transform ${duration}ms cubic-bezier(0.2, 0.8, 0.3, 1)`;
            reel.style.transform = `translateY(${targetY}px)`;
            
            setTimeout(() => {
                resolve();
            }, duration);
        }, delay);
    });
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
async function updateGameStats(spinIncrement = 0, winIncrement = 0, jackpotIncrement = 0) {
    console.log('–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:', { spinIncrement, winIncrement, jackpotIncrement });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    state.spinCount += spinIncrement;
    state.winCount += winIncrement;
    state.jackpots += jackpotIncrement;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º
    saveGameState();
    updateUI();
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ—Ä–µ–∑ API –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
    try {
        if (typeof Api !== 'undefined' && Api.updateStats) {
            const user = Api.getCurrentUser();
            if (user) {
                await Api.updateStats(user.id, spinIncrement, winIncrement, jackpotIncrement);
                console.log('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ API');
            }
        }
    } catch (error) {
        console.log('API –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å:', error);
    }
}

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
async function spin() {
    if (state.isSpinning) return;
    
    if (state.balance <= 0) {
        showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–≤—ë–∑–¥! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.', 2000);
        return;
    }
    
    state.isSpinning = true;
    state.lastWin = 0;
    
    if (elements.spinButton) {
        elements.spinButton.disabled = true;
    }
    
    updateUI();
    
    // –í—ã—á–∏—Ç–∞–µ–º 1 –∑–≤–µ–∑–¥—É –∑–∞ —Å–ø–∏–Ω
    state.balance -= 1;
    
    try {
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ API –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ
        try {
            if (typeof Api !== 'undefined' && Api.updateBalance) {
                const user = Api.getCurrentUser();
                if (user) {
                    await Api.updateBalance(user.id, -1, 0);
                }
            }
        } catch (apiError) {
            console.log('API –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å');
        }
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã
        const newSymbols = [
            getRandomSymbol(),
            getRandomSymbol(),
            getRandomSymbol()
        ];
        
        state.currentSymbols = newSymbols;
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Ä–∞—â–µ–Ω–∏–µ –±–∞—Ä–∞–±–∞–Ω–æ–≤
        await Promise.all([
            spinReel(elements.reel1, newSymbols[0], 0),
            spinReel(elements.reel2, newSymbols[1], 200),
            spinReel(elements.reel3, newSymbols[2], 400)
        ]);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—ã–∏–≥—Ä—ã—à
        const winResult = checkWin(newSymbols);
        
        if (winResult.amount > 0) {
            state.lastWin = winResult.amount;
            state.balance += winResult.amount;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É - –í–´–ò–ì–†–´–®
            const jackpotIncrement = (winResult.type === 'triple' && newSymbols[0] === 'üé∞') ? 1 : 0;
            await updateGameStats(1, 1, jackpotIncrement); // spinCount +1, winCount +1
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å —á–µ—Ä–µ–∑ API
            try {
                if (typeof Api !== 'undefined' && Api.updateBalance) {
                    const user = Api.getCurrentUser();
                    if (user) {
                        await Api.updateBalance(user.id, winResult.amount, 0);
                    }
                }
            } catch (apiError) {
                console.log('API –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–∏–≥—Ä—ã—à–∞ –Ω–µ —É–¥–∞–ª–æ—Å—å');
            }
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (winResult.type === 'triple' && newSymbols[0] === 'üé∞') {
                showNotification(`üéâ –î–ñ–ï–ö–ü–û–¢! +${winResult.amount} –∑–≤—ë–∑–¥! üéâ`, 5000);
            } else if (winResult.type === 'triple') {
                showNotification(`üéä –¢—Ä–∏ –≤ —Ä—è–¥! +${winResult.amount} –∑–≤—ë–∑–¥!`, 3000);
            } else {
                showNotification(`üéØ –î–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö! +${winResult.amount} –∑–≤—ë–∑–¥!`, 3000);
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—ã–∏–≥—Ä—ã—à–∞
            if (elements.winDisplay) {
                elements.winDisplay.classList.add('win-animation');
                setTimeout(() => {
                    elements.winDisplay.classList.remove('win-animation');
                }, 1500);
            }
        } else {
            // –ü—Ä–æ–∏–≥—Ä—ã—à - –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ —Å—á–µ—Ç—á–∏–∫ —Å–ø–∏–Ω–æ–≤
            await updateGameStats(1, 0, 0); // spinCount +1
            showNotification('–ü–æ–≤–µ–∑—ë—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑!', 2000);
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è:', error);
        showNotification('–û—à–∏–±–∫–∞ –≤—Ä–∞—â–µ–Ω–∏—è', 2000);
    } finally {
        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
        state.isSpinning = false;
        
        if (elements.spinButton) {
            elements.spinButton.disabled = false;
        }
        
        updateUI();
        saveGameState();
    }
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∏–≥—Ä—ã—à–Ω–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
function checkWin(results) {
    const combination = results.join('');
    let winAmount = 0;
    let winType = '';
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞
    if (results[0] === results[1] && results[1] === results[2]) {
        const key = results[0] + results[1] + results[2];
        winAmount = CONFIG.payouts[key] || 0;
        winType = 'triple';
    } 
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞
    else {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–µ –¥–≤–∞
        if (results[0] === results[1]) {
            const key = results[0] + results[1];
            winAmount = CONFIG.payouts[key] || 0;
            winType = 'double';
        }
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–∞
        else if (results[1] === results[2]) {
            const key = results[1] + results[2];
            winAmount = CONFIG.payouts[key] || 0;
            winType = 'double';
        }
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–≤—ã–π –∏ —Ç—Ä–µ—Ç–∏–π
        else if (results[0] === results[2]) {
            const key = results[0] + results[2];
            winAmount = CONFIG.payouts[key] || 0;
            winType = 'double';
        }
    }
    
    return { amount: winAmount, type: winType };
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
function setupEventListeners() {
    if (elements.spinButton) {
        elements.spinButton.addEventListener('click', function(e) {
            e.preventDefault();
            spin();
        });
        
        elements.spinButton.addEventListener('mouseenter', () => {
            if (!state.isSpinning) {
                elements.spinButton.style.transform = 'scale(1.05)';
            }
        });
        
        elements.spinButton.addEventListener('mouseleave', () => {
            elements.spinButton.style.transform = 'scale(1)';
        });
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–ª–∞–≤–∏—à–∏ –ø—Ä–æ–±–µ–ª–∞
    document.addEventListener('keydown', function(e) {
        if (e.code === 'Space' && !state.isSpinning && state.balance > 0) {
            e.preventDefault();
            spin();
        }
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
window.debugGame = {
    state: state,
    spin: spin,
    updateUI: updateUI,
    resetStats: function() {
        state.spinCount = 0;
        state.winCount = 0;
        state.jackpots = 0;
        saveGameState();
        updateUI();
        showNotification('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞!', 2000);
    },
    addStars: function(amount) {
        state.balance += amount;
        saveGameState();
        updateUI();
        showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ ${amount} –∑–≤—ë–∑–¥!`, 2000);
    }
};
///////////////////////////////////////////////////////////////////////////////////////////





index.html:
/////////////////////////////////////////////////////////////////////////////////
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emoji Slots üé∞</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="balance-container">
                <div class="balance">
                    <i class="fas fa-star"></i>
                    <span id="balance">0</span>
                </div>
                <div class="balance coins-balance">
                    <i class="fas fa-coins"></i>
                    <span id="coins">0</span>
                </div>
            </div>
            
            <div class="logo">
                <h1><span class="logo-gradient">üé∞ Emoji Slots</span></h1>
                <p class="subtitle">–ö—Ä—É—Ç–∏ –∏ –≤—ã–∏–≥—Ä—ã–≤–∞–π –∑–≤—ë–∑–¥—ã!</p>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <i class="fas fa-trophy"></i>
                    <span id="jackpots">0</span>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="slots-container">
                <div class="slots-machine">
                    <div class="slots-window">
                        <div class="reel-container">
                            <div class="reel" id="reel1"></div>
                        </div>
                        <div class="reel-container">
                            <div class="reel" id="reel2"></div>
                        </div>
                        <div class="reel-container">
                            <div class="reel" id="reel3"></div>
                        </div>
                        <div class="slots-frame"></div>
                    </div>
                </div>
                
                <div class="control-panel">
                    <button class="btn-spin" id="spinButton">
                        <i class="fas fa-play"></i>
                        <span>–ö–†–£–¢–ò–¢–¨</span>
                    </button>
                    
                    <div class="win-display" id="winDisplay">
                        <span>–í—ã–∏–≥—Ä—ã—à: </span>
                        <span id="winAmount">0</span>
                        <i class="fas fa-star"></i>
                    </div>
                </div>
            </div>
            
            <div class="info-panel">
                <h3><i class="fas fa-info-circle"></i> –¢–∞–±–ª–∏—Ü–∞ –≤—ã–∏–≥—Ä—ã—à–µ–π</h3>
                
                <div class="wins-section">
                    <h4><i class="fas fa-crown"></i> 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞</h4>
                    <div class="wins-table">
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üé∞</span><span>üé∞</span><span>üé∞</span>
                            </div>
                            <div class="combo-prize">1000 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üíé</span><span>üíé</span><span>üíé</span>
                            </div>
                            <div class="combo-prize">500 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üîî</span><span>üîî</span><span>üîî</span>
                            </div>
                            <div class="combo-prize">200 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>‚≠ê</span><span>‚≠ê</span><span>‚≠ê</span>
                            </div>
                            <div class="combo-prize">100 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçâ</span><span>üçâ</span><span>üçâ</span>
                            </div>
                            <div class="combo-prize">50 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçä</span><span>üçä</span><span>üçä</span>
                            </div>
                            <div class="combo-prize">30 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçã</span><span>üçã</span><span>üçã</span>
                            </div>
                            <div class="combo-prize">20 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçí</span><span>üçí</span><span>üçí</span>
                            </div>
                            <div class="combo-prize">10 ‚≠ê</div>
                        </div>
                    </div>
                </div>
                
                <div class="wins-section">
                    <h4><i class="fas fa-star"></i> 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞</h4>
                    <div class="wins-table wins-table-double">
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üé∞</span><span>üé∞</span>
                            </div>
                            <div class="combo-prize">50 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üíé</span><span>üíé</span>
                            </div>
                            <div class="combo-prize">40 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üîî</span><span>üîî</span>
                            </div>
                            <div class="combo-prize">30 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>‚≠ê</span><span>‚≠ê</span>
                            </div>
                            <div class="combo-prize">25 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçâ</span><span>üçâ</span>
                            </div>
                            <div class="combo-prize">20 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçä</span><span>üçä</span>
                            </div>
                            <div class="combo-prize">15 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçã</span><span>üçã</span>
                            </div>
                            <div class="combo-prize">10 ‚≠ê</div>
                        </div>
                        <div class="win-combination">
                            <div class="combo-symbols">
                                <span>üçí</span><span>üçí</span>
                            </div>
                            <div class="combo-prize">5 ‚≠ê</div>
                        </div>
                    </div>
                </div>
                
                <div class="stats-info">
                    <div class="stat-item">
                        <i class="fas fa-sync-alt"></i>
                        <span>–í—Å–µ–≥–æ —Å–ø–∏–Ω–æ–≤: <span id="totalSpins">0</span></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-trophy"></i>
                        <span>–ü–æ–±–µ–¥: <span id="totalWins">0</span></span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-percentage"></i>
                        <span>–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥: <span id="winRate">0%</span></span>
                    </div>
                </div>
            </div>
        </main>
        
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É -->
        <nav class="navbar bottom-nav">
            <a href="index.html" class="nav-item active">
                <i class="fas fa-dice"></i>
                <span>–°–ª–æ—Ç—ã</span>
            </a>
            <a href="shop.html" class="nav-item">
                <i class="fas fa-shopping-bag"></i>
                <span>–ú–∞–≥–∞–∑–∏–Ω</span>
            </a>
            <a href="wallet.html" class="nav-item">
                <i class="fas fa-wallet"></i>
                <span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
            </a>
            <a href="profile.html" class="nav-item">
                <i class="fas fa-user"></i>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </a>
        </nav>
        
        <div class="notification" id="notification">
            <span id="notificationText"></span>
        </div>
    </div>
    
    <script src="api.js"></script>
    <script src="app.js"></script>
</body>
</html>
//////////////////////////////////////////////////////////////////////////////////




profile.html:
///////////////////////////////////////////////////////////////////////////////
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å - Emoji Slots</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        

        <header class="header">
            <div class="balance-container">
                <div class="balance">
                    <i class="fas fa-star"></i>
                    <span id="balance">0</span>
                </div>
                <div class="balance coins-balance">
                    <i class="fas fa-coins"></i>
                    <span id="coins">0</span>
                </div>
            </div>
            
            <div class="logo">
                <h1><span class="logo-gradient">üë§ –ü—Ä–æ—Ñ–∏–ª—å</span></h1>
                <p class="subtitle">–í–∞—à–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ –∫–æ–ª–ª–µ–∫—Ü–∏—è</p>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <i class="fas fa-gift"></i>
                    <span id="totalGifts">0</span>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="profile-container">
                <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ -->
                <div class="user-card">
                    <div class="user-avatar" id="userAvatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="user-info">
                        <h3 id="userName">–ì–æ—Å—Ç—å</h3>
                        <p class="user-id" id="userId">ID: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        <div class="user-stats">
                            <div class="stat-item">
                                <i class="fas fa-calendar-alt"></i>
                                <span>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: <span id="joinDate">–°–µ–≥–æ–¥–Ω—è</span></span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã -->
                <div class="stats-section">
                    <h3><i class="fas fa-chart-line"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä—ã</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div class="stat-details">
                                <h4>–í—Å–µ–≥–æ —Å–ø–∏–Ω–æ–≤</h4>
                                <p class="stat-value" id="totalSpins">0</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-trophy"></i>
                            </div>
                            <div class="stat-details">
                                <h4>–í—ã–∏–≥—Ä—ã—à–∏</h4>
                                <p class="stat-value" id="totalWins">0</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-crown"></i>
                            </div>
                            <div class="stat-details">
                                <h4>–î–∂–µ–∫–ø–æ—Ç—ã</h4>
                                <p class="stat-value" id="jackpots">0</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="stat-details">
                                <h4>–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</h4>
                                <p class="stat-value" id="winRate">0%</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –ö–æ–ª–ª–µ–∫—Ü–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤ -->
                <div class="gifts-section">
                    <h3><i class="fas fa-box-open"></i> –í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è</h3>
                    <div class="collection-info">
                        <p>–ö—É–ø–ª–µ–Ω–æ –ø–æ–¥–∞—Ä–∫–æ–≤: <span id="giftsCount">0</span> –∏–∑ <span id="totalAvailable">7</span></p>
                        <progress id="collectionProgress" value="0" max="100"></progress>
                    </div>
                    
                    <div class="gifts-collection" id="giftsCollection">
                        <!-- –ü–æ–¥–∞—Ä–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                        <div class="empty-collection">
                            <i class="fas fa-box-open"></i>
                            <p>–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø—É—Å—Ç–∞</p>
                            <p class="hint">–ö—É–ø–∏—Ç–µ –ø–æ–¥–∞—Ä–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</p>
                        </div>
                    </div>
                </div>
                
                <!-- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è -->
                <div class="achievements-section">
                    <h3><i class="fas fa-medal"></i> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                    <div class="achievements-grid" id="achievementsGrid">
                        <div class="achievement locked">
                            <div class="achievement-icon">üé∞</div>
                            <div class="achievement-info">
                                <h4>–ü–µ—Ä–≤—ã–π –¥–∂–µ–∫–ø–æ—Ç</h4>
                                <p>–í—ã–∏–≥—Ä–∞–π—Ç–µ –¥–∂–µ–∫–ø–æ—Ç</p>
                            </div>
                            <div class="achievement-status">
                                <i class="fas fa-lock"></i>
                            </div>
                        </div>
                        
                        <div class="achievement locked">
                            <div class="achievement-icon">üõçÔ∏è</div>
                            <div class="achievement-info">
                                <h4>–ü–µ—Ä–≤—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å</h4>
                                <p>–ö—É–ø–∏—Ç–µ –ª—é–±–æ–π –ø–æ–¥–∞—Ä–æ–∫</p>
                            </div>
                            <div class="achievement-status">
                                <i class="fas fa-lock"></i>
                            </div>
                        </div>
                        
                        <div class="achievement locked">
                            <div class="achievement-icon">‚≠ê</div>
                            <div class="achievement-info">
                                <h4>–ó–≤—ë–∑–¥–Ω—ã–π –∏–≥—Ä–æ–∫</h4>
                                <p>–ù–∞–∫–æ–ø–∏—Ç–µ 1000 –∑–≤—ë–∑–¥</p>
                            </div>
                            <div class="achievement-status">
                                <i class="fas fa-lock"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        
        <div class="notification" id="notification">
            <span id="notificationText"></span>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É -->
<nav class="navbar bottom-nav">
    <a href="index.html" class="nav-item">
        <i class="fas fa-dice"></i>
        <span>–°–ª–æ—Ç—ã</span>
    </a>
    <a href="shop.html" class="nav-item ">
        <i class="fas fa-shopping-bag"></i>
        <span>–ú–∞–≥–∞–∑–∏–Ω</span>
    </a>
    <a href="wallet.html" class="nav-item">
        <i class="fas fa-wallet"></i>
        <span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
    </a>
    <a href="profile.html" class="nav-item active">
        <i class="fas fa-user"></i>
        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
</nav>

    </div>
    
    <script src="api.js"></script>
    <script src="profile.js"></script>
</body>
</html>
//////////////////////////////////////////////////////////////////////////////




profile.js:
//////////////////////////////////////////////////////////////////////////////
// profile.js - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è
const elements = {
    balance: document.getElementById('balance'),
    coins: document.getElementById('coins'),
    totalGifts: document.getElementById('totalGifts'),
    userAvatar: document.getElementById('userAvatar'),
    userName: document.getElementById('userName'),
    userId: document.getElementById('userId'),
    joinDate: document.getElementById('joinDate'),
    totalSpins: document.getElementById('totalSpins'),
    totalWins: document.getElementById('totalWins'),
    jackpots: document.getElementById('jackpots'),
    winRate: document.getElementById('winRate'),
    giftsCount: document.getElementById('giftsCount'),
    totalAvailable: document.getElementById('totalAvailable'),
    collectionProgress: document.getElementById('collectionProgress'),
    giftsCollection: document.getElementById('giftsCollection'),
    achievementsGrid: document.getElementById('achievementsGrid'),
    notification: document.getElementById('notification'),
    notificationText: document.getElementById('notificationText')
};

let giftsList = [];

async function init() {
    await loadUserData();
    await loadGifts();
    setupEventListeners();
    renderProfile();
    renderGiftsCollection();
    renderAchievements();
}

async function loadUserData() {
    try {
        // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ localStorage
        const localState = localStorage.getItem('gameState');
        if (localState) {
            const gameState = JSON.parse(localState);
            updateUIFromGameState(gameState);
        }
        
        // –ó–∞—Ç–µ–º –ø—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ API
        if (typeof Api !== 'undefined' && Api.getCurrentUser) {
            const user = Api.getCurrentUser();
            if (user) {
                updateUIFromUser(user);
                
                // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
                const localStats = {
                    spinCount: user.spin_count || 0,
                    winCount: user.win_count || 0,
                    jackpots: user.jackpots || 0
                };
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è
                localStorage.setItem('userStats', JSON.stringify(localStats));
            }
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
    }
}

function updateUIFromGameState(gameState) {
    if (!gameState) return;
    
    if (elements.balance) elements.balance.textContent = gameState.balance || 0;
    if (elements.coins) elements.coins.textContent = gameState.coins || 0;
    if (elements.totalSpins) elements.totalSpins.textContent = gameState.spinCount || 0;
    if (elements.totalWins) elements.totalWins.textContent = gameState.winCount || 0;
    if (elements.jackpots) elements.jackpots.textContent = gameState.jackpots || 0;
    
    if (elements.winRate) {
        const spins = gameState.spinCount || 0;
        const wins = gameState.winCount || 0;
        const winRate = spins > 0 ? Math.round((wins / spins) * 100) : 0;
        elements.winRate.textContent = `${winRate}%`;
    }
}

function updateUIFromUser(user) {
    if (!user) return;
    
    // –ë–∞–ª–∞–Ω—Å
    if (elements.balance) elements.balance.textContent = user.balance || 0;
    if (elements.coins) elements.coins.textContent = user.coins || 0;
    
    // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    if (elements.totalSpins) {
        elements.totalSpins.textContent = user.spin_count || user.spinCount || 0;
    }
    
    if (elements.totalWins) {
        elements.totalWins.textContent = user.win_count || user.winCount || 0;
    }
    
    if (elements.jackpots) {
        elements.jackpots.textContent = user.jackpots || 0;
    }
    
    if (elements.winRate) {
        const spins = user.spin_count || user.spinCount || 0;
        const wins = user.win_count || user.winCount || 0;
        const winRate = spins > 0 ? Math.round((wins / spins) * 100) : 0;
        elements.winRate.textContent = `${winRate}%`;
    }
    
    // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
    if (elements.userName) {
        elements.userName.textContent = user.username || '–ì–æ—Å—Ç—å';
    }
    
    if (elements.userId) {
        elements.userId.textContent = `ID: ${user.id || '–ù–µ–∏–∑–≤–µ—Å—Ç–µ–Ω'}`;
    }
    
    if (elements.joinDate && user.join_date) {
        const date = new Date(user.join_date);
        elements.joinDate.textContent = date.toLocaleDateString('ru-RU');
    } else if (elements.joinDate) {
        elements.joinDate.textContent = '–°–µ–≥–æ–¥–Ω—è';
    }
    
    // –ê–≤–∞—Ç–∞—Ä
    if (user.photo_url && elements.userAvatar) {
        elements.userAvatar.innerHTML = `<img src="${user.photo_url}" alt="–ê–≤–∞—Ç–∞—Ä" style="width:100%;height:100%;border-radius:50%;">`;
    } else if (elements.userAvatar) {
        elements.userAvatar.innerHTML = '<i class="fas fa-user-circle" style="font-size:60px;"></i>';
    }
}

async function loadGifts() {
    try {
        if (typeof Api !== 'undefined' && Api.getGifts) {
            const result = await Api.getGifts();
            if (result.success) {
                giftsList = result.gifts;
            }
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–¥–∞—Ä–∫–æ–≤:', error);
    }
}

function renderProfile() {
    let user = null;
    
    // –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ API
    if (typeof Api !== 'undefined' && Api.getCurrentUser) {
        user = Api.getCurrentUser();
    }
    
    // –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ API, —Å–æ–∑–¥–∞–µ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ
    if (!user) {
        const localData = localStorage.getItem('userData');
        if (localData) {
            user = JSON.parse(localData);
        }
    }
    
    if (!user) {
        user = {
            gifts: [],
            username: '–ì–æ—Å—Ç—å'
        };
    }
    
    const userGifts = user.gifts || [];
    const totalGifts = giftsList.length;
    const progress = totalGifts > 0 ? (userGifts.length / totalGifts) * 100 : 0;
    
    if (elements.giftsCount) {
        elements.giftsCount.textContent = userGifts.length;
    }
    
    if (elements.totalAvailable) {
        elements.totalAvailable.textContent = totalGifts;
    }
    
    if (elements.collectionProgress) {
        elements.collectionProgress.value = progress;
    }
    
    if (elements.totalGifts) {
        elements.totalGifts.textContent = userGifts.length;
    }
}

function renderGiftsCollection() {
    let user = null;
    
    if (typeof Api !== 'undefined' && Api.getCurrentUser) {
        user = Api.getCurrentUser();
    }
    
    if (!user) {
        const localData = localStorage.getItem('userData');
        if (localData) {
            user = JSON.parse(localData);
        }
    }
    
    if (!user) return;
    
    const userGifts = user.gifts || [];
    
    if (userGifts.length === 0) {
        if (elements.giftsCollection) {
            elements.giftsCollection.innerHTML = `
                <div class="empty-collection">
                    <i class="fas fa-box-open"></i>
                    <p>–í–∞—à–∞ –∫–æ–ª–ª–µ–∫—Ü–∏—è –ø—É—Å—Ç–∞</p>
                    <p class="hint">–ö—É–ø–∏—Ç–µ –ø–æ–¥–∞—Ä–∫–∏ –≤ –º–∞–≥–∞–∑–∏–Ω–µ!</p>
                </div>
            `;
        }
        return;
    }
    
    if (elements.giftsCollection) {
        elements.giftsCollection.innerHTML = '';
        
        // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∫—É–ø–ª–µ–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏
        const ownedGifts = giftsList.filter(gift => 
            userGifts.some(userGift => userGift.id === gift.id)
        );
        
        ownedGifts.forEach(gift => {
            const giftItem = document.createElement('div');
            giftItem.className = 'gift-collection-item';
            
            giftItem.innerHTML = `
                <div class="gift-icon">${gift.emoji}</div>
                <div class="gift-name">${gift.name}</div>
            `;
            
            elements.giftsCollection.appendChild(giftItem);
        });
    }
}

function renderAchievements() {
    let user = null;
    let gameState = null;
    
    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if (typeof Api !== 'undefined' && Api.getCurrentUser) {
        user = Api.getCurrentUser();
    }
    
    // –ü–æ–ª—É—á–∞–µ–º –∏–≥—Ä–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    const localState = localStorage.getItem('gameState');
    if (localState) {
        gameState = JSON.parse(localState);
    }
    
    // –û–±—ä–µ–¥–∏–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
    const stats = {
        balance: (user?.balance || gameState?.balance || 0),
        coins: (user?.coins || gameState?.coins || 0),
        spinCount: (user?.spin_count || gameState?.spinCount || 0),
        winCount: (user?.win_count || gameState?.winCount || 0),
        jackpots: (user?.jackpots || gameState?.jackpots || 0),
        gifts: user?.gifts || []
    };
    
    const achievements = [
        {
            id: 'first_jackpot',
            title: '–ü–µ—Ä–≤—ã–π –¥–∂–µ–∫–ø–æ—Ç',
            description: '–í—ã–∏–≥—Ä–∞–π—Ç–µ –¥–∂–µ–∫–ø–æ—Ç',
            icon: 'üé∞',
            condition: (stats) => stats.jackpots > 0
        },
        {
            id: 'first_purchase',
            title: '–ü–µ—Ä–≤—ã–π –ø–æ–∫—É–ø–∞—Ç–µ–ª—å',
            description: '–ö—É–ø–∏—Ç–µ –ª—é–±–æ–π –ø–æ–¥–∞—Ä–æ–∫',
            icon: 'üõçÔ∏è',
            condition: (stats) => stats.gifts && stats.gifts.length > 0
        },
        {
            id: 'star_player',
            title: '–ó–≤—ë–∑–¥–Ω—ã–π –∏–≥—Ä–æ–∫',
            description: '–ù–∞–∫–æ–ø–∏—Ç–µ 1000 –∑–≤—ë–∑–¥',
            icon: '‚≠ê',
            condition: (stats) => stats.balance >= 1000
        },
        {
            id: 'spinning_king',
            title: '–ö–æ—Ä–æ–ª—å –≤—Ä–∞—â–µ–Ω–∏–π',
            description: '–°–¥–µ–ª–∞–π—Ç–µ 100 —Å–ø–∏–Ω–æ–≤',
            icon: 'üëë',
            condition: (stats) => stats.spinCount >= 100
        },
        {
            id: 'rich_chemist',
            title: '–ë–æ–≥–∞—Ç—ã–π —Ö–∏–º–∏–∫',
            description: '–°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –ø–æ–¥–∞—Ä–∫–∏ –Ω–∞–±–æ—Ä–∞',
            icon: 'üß™',
            condition: (stats) => stats.gifts && stats.gifts.length >= (giftsList.length || 7)
        }
    ];
    
    if (elements.achievementsGrid) {
        elements.achievementsGrid.innerHTML = '';
        
        achievements.forEach(achievement => {
            const isUnlocked = achievement.condition(stats);
            
            const achievementEl = document.createElement('div');
            achievementEl.className = `achievement ${isUnlocked ? 'unlocked' : 'locked'}`;
            
            achievementEl.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div class="achievement-info">
                    <h4>${achievement.title}</h4>
                    <p>${achievement.description}</p>
                </div>
                <div class="achievement-status">
                    ${isUnlocked ? '‚úÖ' : '<i class="fas fa-lock"></i>'}
                </div>
            `;
            
            elements.achievementsGrid.appendChild(achievementEl);
        });
    }
}

function setupEventListeners() {
    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
//////////////////////////////////////////////////////////////////////////////




shop.html:
//////////////////////////////////////////////////////////////////////////////
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤ - Emoji Slots</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        

        <header class="header">
            <div class="balance-container">
                <div class="balance">
                    <i class="fas fa-star"></i>
                    <span id="balance">0</span>
                </div>
                <div class="balance coins-balance">
                    <i class="fas fa-coins"></i>
                    <span id="coins">0</span>
                </div>
            </div>
            
            <div class="logo">
                <h1><span class="logo-gradient">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</span></h1>
                <p class="subtitle">–ü–æ–∫—É–ø–∞–π –ø–æ–¥–∞—Ä–∫–∏ –∑–∞ –∑–≤—ë–∑–¥—ã –∏ –º–æ–Ω–µ—Ç—ã</p>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <i class="fas fa-gift"></i>
                    <span id="giftsCount">0</span>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="shop-container">
                <div class="category-title">
                    <h3><i class="fas fa-flask"></i> –ù–∞–±–æ—Ä —é–Ω–æ–≥–æ —Ö–∏–º–∏–∫–∞</h3>
                    <p class="category-description">–ö–æ–ª–ª–µ–∫—Ü–∏—è –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö, –Ω–æ —Å–º–µ—à–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤</p>
                </div>
                
                <div class="gifts-grid" id="giftsGrid">
                    <!-- –ü–æ–¥–∞—Ä–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
                
                <div class="instructions">
                    <h4><i class="fas fa-info-circle"></i> –ö–∞–∫ –∫—É–ø–∏—Ç—å?</h4>
                    <p>1. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–¥–∞—Ä–æ–∫ –¥–ª—è –ø–æ–∫—É–ø–∫–∏</p>
                    <p>2. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–æ–∫—É–ø–∫—É</p>
                    <p>3. –ö—É–ø–ª–µ–Ω–Ω—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –≤ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ</p>
                    <p class="note">üí° –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–∞—Ä–∫–∏ —Ç—Ä–µ–±—É—é—Ç –º–æ–Ω–µ—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∫—É–ø–∏—Ç—å –≤–æ –≤–∫–ª–∞–¥–∫–µ "–ü–æ–ø–æ–ª–Ω–∏—Ç—å"</p>
                </div>
            </div>
        </main>
        
        <div class="notification" id="notification">
            <span id="notificationText"></span>
        </div>
        
        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∫—É–ø–∫–∏ -->
        <div class="modal" id="purchaseModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">–ü–æ–∫—É–ø–∫–∞ –ø–æ–¥–∞—Ä–∫–∞</h3>
                    <button class="modal-close" id="modalClose">&times;</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω —á–µ—Ä–µ–∑ JS -->
                </div>
                <div class="modal-footer">
                    <button class="btn-secondary" id="modalCancel">–û—Ç–º–µ–Ω–∞</button>
                    <button class="btn-primary" id="modalConfirm">–ö—É–ø–∏—Ç—å</button>
                </div>
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É -->
<nav class="navbar bottom-nav">
    <a href="index.html" class="nav-item">
        <i class="fas fa-dice"></i>
        <span>–°–ª–æ—Ç—ã</span>
    </a>
    <a href="shop.html" class="nav-item active">
        <i class="fas fa-shopping-bag"></i>
        <span>–ú–∞–≥–∞–∑–∏–Ω</span>
    </a>
    <a href="wallet.html" class="nav-item">
        <i class="fas fa-wallet"></i>
        <span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
    </a>
    <a href="profile.html" class="nav-item">
        <i class="fas fa-user"></i>
        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
</nav>

    </div>
    
    <script src="api.js"></script>
    <script src="shop.js"></script>
</body>
</html>
///////////////////////////////////////////////////////////////////////////////



shop.js:
//////////////////////////////////////////////////////////////////////////////
// shop.js
const elements = {
    balance: document.getElementById('balance'),
    coins: document.getElementById('coins'),
    giftsCount: document.getElementById('giftsCount'),
    giftsGrid: document.getElementById('giftsGrid'),
    purchaseModal: document.getElementById('purchaseModal'),
    modalTitle: document.getElementById('modalTitle'),
    modalBody: document.getElementById('modalBody'),
    modalClose: document.getElementById('modalClose'),
    modalCancel: document.getElementById('modalCancel'),
    modalConfirm: document.getElementById('modalConfirm'),
    notification: document.getElementById('notification'),
    notificationText: document.getElementById('notificationText')
};

let selectedGift = null;
let giftsList = [];

async function init() {
    await loadUserData();
    await loadGifts();
    setupEventListeners();
    renderGifts();
}

async function loadUserData() {
    const user = Api.getCurrentUser();
    if (user) {
        updateUIFromUser(user);
    }
}

function updateUIFromUser(user) {
    if (elements.balance) elements.balance.textContent = user.balance || 0;
    if (elements.coins) elements.coins.textContent = user.coins || 0;
    if (elements.giftsCount) elements.giftsCount.textContent = user.gifts ? user.gifts.length : 0;
}

async function loadGifts() {
    const result = await Api.getGifts();
    if (result.success) {
        giftsList = result.gifts;
    }
}

function renderGifts() {
    const user = Api.getCurrentUser();
    const userGifts = user ? user.gifts || [] : [];
    
    elements.giftsGrid.innerHTML = '';
    
    giftsList.forEach(gift => {
        const isOwned = userGifts.some(g => g.id === gift.id);
        
        const giftCard = document.createElement('div');
        giftCard.className = `gift-card ${isOwned ? 'owned' : ''}`;
        giftCard.dataset.id = gift.id;
        
        giftCard.innerHTML = `
            ${isOwned ? '<div class="owned-badge">–ö—É–ø–ª–µ–Ω–æ</div>' : ''}
            <div class="gift-icon">${gift.emoji}</div>
            <div class="gift-name">${gift.name}</div>
            <div class="gift-price ${gift.currency}">
                <span>${gift.price}</span>
                <span>${gift.currency === 'stars' ? '‚≠ê' : 'ü™ô'}</span>
            </div>
            <div class="gift-description">${gift.description}</div>
            <button class="buy-btn" ${isOwned ? 'disabled' : ''}>
                ${isOwned ? '–ö—É–ø–ª–µ–Ω–æ' : '–ö—É–ø–∏—Ç—å'}
            </button>
        `;
        
        if (!isOwned) {
            giftCard.querySelector('.buy-btn').addEventListener('click', () => openPurchaseModal(gift));
        }
        
        elements.giftsGrid.appendChild(giftCard);
    });
}

function openPurchaseModal(gift) {
    selectedGift = gift;
    const user = Api.getCurrentUser();
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –±–∞–ª–∞–Ω—Å
    const userBalance = gift.currency === 'stars' ? (user.balance || 0) : (user.coins || 0);
    const hasEnough = userBalance >= gift.price;
    
    elements.modalTitle.textContent = `–ü–æ–∫—É–ø–∫–∞: ${gift.name}`;
    
    elements.modalBody.innerHTML = `
        <div class="modal-gift-info">
            <div class="modal-gift-icon">${gift.emoji}</div>
            <div class="modal-gift-name">${gift.name}</div>
            <div class="modal-gift-description">${gift.description}</div>
            <div class="modal-price ${gift.currency}">
                <span>–¶–µ–Ω–∞: ${gift.price}</span>
                <span>${gift.currency === 'stars' ? '‚≠ê' : 'ü™ô'}</span>
            </div>
        </div>
        <div class="modal-balance-check">
            <p>–í–∞—à –±–∞–ª–∞–Ω—Å: ${userBalance} ${gift.currency === 'stars' ? '–∑–≤—ë–∑–¥' : '–º–æ–Ω–µ—Ç'}</p>
            <p class="${hasEnough ? 'sufficient' : 'insufficient'}">
                ${hasEnough ? '‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤' : '‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤'}
            </p>
        </div>
    `;
    
    elements.modalConfirm.disabled = !hasEnough;
    elements.purchaseModal.classList.add('show');
}

async function purchaseGift() {
    if (!selectedGift) return;
    
    const user = Api.getCurrentUser();
    if (!user) return;
    
    try {
        // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
        const starsDelta = selectedGift.currency === 'stars' ? -selectedGift.price : 0;
        const coinsDelta = selectedGift.currency === 'coins' ? -selectedGift.price : 0;
        
        await Api.updateBalance(user.id, starsDelta, coinsDelta);
        
        // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥–∞—Ä–æ–∫
        await Api.purchaseGift(user.id, selectedGift.id);
        
        showNotification(`üéÅ –í—ã –∫—É–ø–∏–ª–∏ "${selectedGift.name}"!`, 3000);
        
        // –û–±–Ω–æ–≤–ª—è–µ–º UI
        updateUIFromUser(Api.getCurrentUser());
        renderGifts();
        
        closePurchaseModal();
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏', 2000);
    }
}

function closePurchaseModal() {
    elements.purchaseModal.classList.remove('show');
    selectedGift = null;
}

function showNotification(message, duration = 3000) {
    elements.notificationText.textContent = message;
    elements.notification.classList.add('show');
    
    setTimeout(() => {
        elements.notification.classList.remove('show');
    }, duration);
}

function setupEventListeners() {
    elements.modalClose.addEventListener('click', closePurchaseModal);
    elements.modalCancel.addEventListener('click', closePurchaseModal);
    elements.modalConfirm.addEventListener('click', purchaseGift);
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
    elements.purchaseModal.addEventListener('click', (e) => {
        if (e.target === elements.purchaseModal) {
            closePurchaseModal();
        }
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
//////////////////////////////////////////////////////////////////////////////



style.css:
//////////////////////////////////////////////////////////////////////////////
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    color: #fff;
    min-height: 100vh;
    padding: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.container {
    width: 100%;
    max-width: 500px;
    background: rgba(30, 30, 46, 0.9);
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
.navbar {
    display: flex;
    justify-content: space-around;
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 10px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 10px 15px;
    text-decoration: none;
    color: #aaa;
    border-radius: 10px;
    transition: all 0.3s;
    min-width: 70px;
}

.nav-item i {
    font-size: 20px;
    margin-bottom: 5px;
}

.nav-item span {
    font-size: 12px;
    font-weight: 500;
}

.nav-item:hover {
    background: rgba(255, 255, 255, 0.05);
    color: #fff;
}

.nav-item.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(255, 255, 255, 0.1);
}

.balance-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 120px;
}

.balance {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 215, 0, 0.15);
    padding: 10px 15px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 18px;
    border: 2px solid rgba(255, 215, 0, 0.3);
}

.coins-balance {
    background: rgba(0, 123, 255, 0.15);
    border-color: rgba(0, 123, 255, 0.3);
}

.coins-balance i {
    color: #00bfff;
}

.balance i {
    color: gold;
}

.logo {
    text-align: center;
    flex-grow: 1;
}

.logo-gradient {
    background: linear-gradient(135deg, #00dbde 0%, #fc00ff 100%);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    display: inline-block;
}

.logo h1 {
    font-size: 24px;
    margin-bottom: 5px;
}

.subtitle {
    font-size: 12px;
    color: #aaa;
}

.stats {
    display: flex;
    gap: 15px;
    min-width: 120px;
    justify-content: flex-end;
}

.stat {
    display: flex;
    align-items: center;
    gap: 5px;
    background: rgba(0, 123, 255, 0.15);
    padding: 8px 12px;
    border-radius: 50px;
    font-weight: bold;
}

.stat i {
    color: #00bfff;
}

/* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
.main-content {
    margin-bottom: 70px; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞–≥–∞–∑–∏–Ω–∞ */
.shop-container {
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.category-title {
    margin-bottom: 20px;
    text-align: center;
}

.category-title h3 {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    color: #00dbde;
    font-size: 22px;
    margin-bottom: 5px;
}

.category-description {
    color: #aaa;
    font-size: 14px;
    font-style: italic;
}

.gifts-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 25px;
}

.gift-card {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    transition: all 0.3s;
    border: 2px solid transparent;
    cursor: pointer;
    position: relative;
    overflow: hidden;
}

.gift-card:hover {
    transform: translateY(-5px);
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 215, 0, 0.3);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.gift-card.owned {
    border-color: rgba(0, 200, 83, 0.3);
    background: rgba(0, 200, 83, 0.05);
}

.gift-card.owned .gift-icon {
    filter: brightness(1.2);
}

.gift-icon {
    font-size: 40px;
    margin-bottom: 10px;
    display: block;
    min-height: 50px;
}

.gift-name {
    font-weight: bold;
    margin-bottom: 8px;
    font-size: 16px;
}

.gift-price {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    font-weight: bold;
    margin-bottom: 10px;
    padding: 5px 10px;
    border-radius: 20px;
    background: rgba(0, 0, 0, 0.3);
}

.price-stars {
    color: gold;
}

.price-coins {
    color: #00bfff;
}

.gift-description {
    font-size: 12px;
    color: #aaa;
    margin-bottom: 10px;
    min-height: 36px;
}

.buy-btn {
    width: 100%;
    padding: 8px 15px;
    border: none;
    border-radius: 20px;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.buy-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
}

.buy-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.owned-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: rgba(0, 200, 83, 0.9);
    color: white;
    padding: 3px 8px;
    border-radius: 10px;
    font-size: 10px;
    font-weight: bold;
}

.instructions {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 10px;
    margin-top: 20px;
    border-left: 4px solid #667eea;
}

.instructions h4 {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
    color: #00dbde;
}

.instructions p {
    margin-bottom: 5px;
    font-size: 14px;
    line-height: 1.4;
}

.instructions .note {
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    color: gold;
    font-style: italic;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è */
.wallet-container {
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.wallet-section {
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.wallet-section:last-child {
    margin-bottom: 0;
    border-bottom: none;
}

.wallet-section h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #00dbde;
    font-size: 20px;
    margin-bottom: 10px;
}

.section-description {
    color: #aaa;
    margin-bottom: 15px;
    font-size: 14px;
}

.stars-packs, .coins-packs {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.pack-card {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    transition: all 0.3s;
    border: 2px solid transparent;
}

.pack-card:hover {
    transform: translateY(-3px);
    border-color: rgba(255, 215, 0, 0.3);
    background: rgba(255, 255, 255, 0.1);
}

.pack-icon {
    font-size: 30px;
    margin-bottom: 10px;
}

.pack-info h4 {
    margin-bottom: 5px;
    font-size: 18px;
}

.pack-price {
    color: gold;
    font-weight: bold;
    margin-bottom: 10px;
    font-size: 14px;
}

.btn-buy {
    width: 100%;
    padding: 8px 15px;
    border: none;
    border-radius: 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-buy:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.ton-connect {
    background: rgba(0, 123, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    border: 2px solid rgba(0, 123, 255, 0.3);
}

.ton-info {
    display: flex;
    align-items: center;
    gap: 15px;
}

.ton-icon {
    font-size: 40px;
}

.ton-details h4 {
    margin-bottom: 5px;
    color: #00bfff;
}

.ton-details p {
    color: #aaa;
    font-size: 14px;
}

.btn-connect {
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    background: linear-gradient(135deg, #0088cc 0%, #0055aa 100%);
    color: white;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.3s;
}

.btn-connect:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0, 136, 204, 0.4);
}

.payment-info {
    background: rgba(0, 200, 83, 0.1);
    padding: 10px 15px;
    border-radius: 10px;
    border-left: 4px solid #00c853;
    margin-top: 15px;
}

.payment-info p {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è */
.profile-container {
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.user-card {
    display: flex;
    align-items: center;
    gap: 20px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px;
    margin-bottom: 25px;
    border: 2px solid rgba(255, 255, 255, 0.1);
}

.user-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
}

.user-info h3 {
    font-size: 24px;
    margin-bottom: 5px;
    color: #00dbde;
}

.user-id {
    color: #aaa;
    font-size: 14px;
    margin-bottom: 10px;
}

.user-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.user-stats .stat-item {
    background: rgba(0, 0, 0, 0.3);
    padding: 5px 10px;
    border-radius: 20px;
    font-size: 12px;
}

.stats-section {
    margin-bottom: 25px;
}

.stats-section h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #00dbde;
    font-size: 20px;
    margin-bottom: 15px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
}

.stat-card {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s;
}

.stat-card:hover {
    transform: translateY(-3px);
    background: rgba(255, 255, 255, 0.1);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
}

.stat-details h4 {
    font-size: 14px;
    color: #aaa;
    margin-bottom: 5px;
}

.stat-value {
    font-size: 24px;
    font-weight: bold;
    color: gold;
}

.gifts-section {
    margin-bottom: 25px;
}

.gifts-section h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #00dbde;
    font-size: 20px;
    margin-bottom: 15px;
}

.collection-info {
    background: rgba(0, 0, 0, 0.3);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    text-align: center;
}

collection-info p {
    margin-bottom: 10px;
    font-weight: bold;
}

collection-info progress {
    width: 100%;
    height: 10px;
    border-radius: 5px;
    overflow: hidden;
}

collection-info progress::-webkit-progress-bar {
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 5px;
}

collection-info progress::-webkit-progress-value {
    background: linear-gradient(135deg, #00dbde 0%, #fc00ff 100%);
    border-radius: 5px;
}

.gifts-collection {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 15px;
}

.gift-collection-item {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    text-align: center;
    border: 2px solid rgba(255, 215, 0, 0.3);
}

.gift-collection-item .gift-icon {
    font-size: 30px;
    margin-bottom: 10px;
}

.gift-collection-item .gift-name {
    font-size: 14px;
}

.empty-collection {
    grid-column: 1 / -1;
    text-align: center;
    padding: 40px 20px;
    color: #aaa;
}

.empty-collection i {
    font-size: 50px;
    margin-bottom: 15px;
    color: #667eea;
}

.empty-collection .hint {
    color: gold;
    font-style: italic;
    margin-top: 10px;
}

.achievements-section h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #00dbde;
    font-size: 20px;
    margin-bottom: 15px;
}

.achievements-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
}

.achievement {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 15px;
    display: flex;
    align-items: center;
    gap: 15px;
    transition: all 0.3s;
}

.achievement.unlocked {
    border: 2px solid rgba(255, 215, 0, 0.3);
    background: rgba(255, 215, 0, 0.05);
}

.achievement.locked {
    opacity: 0.6;
}

.achievement-icon {
    font-size: 30px;
    min-width: 50px;
    text-align: center;
}

.achievement-info h4 {
    margin-bottom: 5px;
    font-size: 16px;
}

.achievement-info p {
    font-size: 12px;
    color: #aaa;
}

.achievement-status {
    margin-left: auto;
}

.achievement.unlocked .achievement-status {
    color: gold;
}

.achievement.locked .achievement-status {
    color: #aaa;
}

/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal.show {
    display: flex;
}

.modal-content {
    background: rgba(30, 30, 46, 0.95);
    border-radius: 20px;
    width: 100%;
    max-width: 400px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
    overflow: hidden;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.3);
}

.modal-header h3 {
    color: #00dbde;
    font-size: 20px;
}

.modal-close {
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s;
}

.modal-close:hover {
    background: rgba(255, 255, 255, 0.1);
}

.modal-body {
    padding: 20px;
    max-height: 400px;
    overflow-y: auto;
}

.modal-gift-info {
    text-align: center;
    padding: 20px 0;
}

.modal-gift-icon {
    font-size: 60px;
    margin-bottom: 20px;
}

.modal-gift-name {
    font-size: 24px;
    margin-bottom: 10px;
    color: #00dbde;
}

.modal-gift-description {
    color: #aaa;
    margin-bottom: 20px;
    font-size: 14px;
    line-height: 1.5;
}

.modal-price {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 20px;
    padding: 10px 20px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 20px;
    border: 2px solid rgba(255, 215, 0, 0.3);
}

.modal-price.coins {
    border-color: rgba(0, 123, 255, 0.3);
}

.modal-balance-check {
    background: rgba(0, 0, 0, 0.2);
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    border-left: 4px solid #00c853;
}

.modal-balance-check p {
    margin-bottom: 5px;
    font-size: 14px;
}

.modal-balance-check .insufficient {
    color: #ff4757;
    font-weight: bold;
}

.modal-balance-check .sufficient {
    color: #00c853;
    font-weight: bold;
}

.modal-footer {
    display: flex;
    gap: 10px;
    padding: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.3);
}

.btn-primary, .btn-secondary {
    flex: 1;
    padding: 12px 20px;
    border: none;
    border-radius: 20px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s;
}

.btn-primary {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    color: white;
}

.btn-primary:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
}

.btn-secondary {
    background: rgba(255, 255, 255, 0.1);
    color: white;
}

.btn-secondary:hover {
    background: rgba(255, 255, 255, 0.2);
}

.btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
.notification {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%) translateY(100px);
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 15px 30px;
    border-radius: 50px;
    font-weight: bold;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    z-index: 1000;
    transition: transform 0.5s ease-in-out;
    opacity: 0;
}

.notification.show {
    transform: translateX(-50%) translateY(0);
    opacity: 1;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 480px) {
    .container {
        padding: 15px;
    }
    
    .navbar {
        padding: 8px;
    }
    
    .nav-item {
        padding: 8px 10px;
        min-width: 60px;
    }
    
    .nav-item i {
        font-size: 18px;
    }
    
    .nav-item span {
        font-size: 11px;
    }
    
    .header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
    }
    
    .balance-container {
        width: 100%;
        flex-direction: row;
        justify-content: center;
    }
    
    .stats {
        width: 100%;
        justify-content: center;
    }
    
    .gifts-grid, .stars-packs, .coins-packs {
        grid-template-columns: repeat(2, 1fr);
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .achievements-grid {
        grid-template-columns: 1fr;
    }
    
    .modal-content {
        margin: 10px;
    }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ (–¥–æ–±–∞–≤—å—Ç–µ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç) */
.slots-container {
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
}

.slots-machine {
    position: relative;
    margin-bottom: 25px;
}

.slots-window {
    display: flex;
    justify-content: space-between;
    background: rgba(10, 10, 20, 0.9);
    border-radius: 10px;
    padding: 0;
    position: relative;
    height: 180px;
    border: 3px solid #333;
    overflow: hidden;
}

.reel-container {
    width: 32%;
    height: 100%;
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    background: rgba(0, 0, 0, 0.3);
}

.reel {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: auto;
    transition: transform 2s cubic-bezier(0.2, 0.8, 0.3, 1);
}

.slot-item {
    height: 60px;
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40px;
    font-weight: bold;
    text-shadow: 0 0 10px currentColor;
    user-select: none;
    padding: 10px 0;
}

/* –¶–≤–µ—Ç–∞ –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤ */
.slot-item.cherry { color: #ff4757; }
.slot-item.lemon { color: #ffd700; }
.slot-item.orange { color: #ff8c00; }
.slot-item.watermelon { color: #2ed573; }
.slot-item.star { color: gold; text-shadow: 0 0 15px gold; }
.slot-item.bell { color: #ffd700; }
.slot-item.diamond { color: #00d2ff; text-shadow: 0 0 15px #00d2ff; }
.slot-item.seven { color: #ff3838; text-shadow: 0 0 15px #ff3838; }

.slots-frame {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255,255,255,0.05) 33%, 
        transparent 34%, 
        transparent 66%, 
        rgba(255,255,255,0.05) 67%, 
        transparent 100%);
}

.slots-frame::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, 
        transparent, 
        gold, 
        transparent);
    transform: translateY(-1px);
    z-index: 2;
}

.control-panel {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
}

.btn-spin {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    border: none;
    color: white;
    font-size: 20px;
    font-weight: bold;
    padding: 18px 50px;
    border-radius: 50px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
    transition: transform 0.2s, box-shadow 0.2s;
    box-shadow: 0 5px 15px rgba(245, 87, 108, 0.4);
}

.btn-spin:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 8px 20px rgba(245, 87, 108, 0.6);
}

.btn-spin:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.win-display {
    display: flex;
    align-items: center;
    gap: 10px;
    background: rgba(0, 200, 83, 0.15);
    padding: 12px 20px;
    border-radius: 50px;
    font-weight: bold;
    font-size: 18px;
    border: 2px solid rgba(0, 200, 83, 0.3);
}

.win-display i {
    color: gold;
}

.win-animation {
    animation: winPulse 0.5s ease-in-out 3;
}

@keyframes winPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –≤—ã–∏–≥—Ä—ã—à–µ–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å–ª–æ—Ç–æ–≤ */
.info-panel {
    background: rgba(20, 20, 35, 0.8);
    border-radius: 15px;
    padding: 20px;
    border: 2px solid rgba(255, 255, 255, 0.1);
    margin-top: 20px;
}

.info-panel h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    color: #00dbde;
    font-size: 20px;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.wins-section {
    margin-bottom: 25px;
}

.wins-section:last-child {
    margin-bottom: 15px;
}

.wins-section h4 {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 15px;
    color: #ffd700;
    font-size: 18px;
}

.wins-section h4 i {
    font-size: 16px;
}

.wins-table {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 20px;
}

.wins-table-double {
    margin-bottom: 25px;
}

.wins-table-double .combo-symbols {
    gap: 8px;
}

.wins-table-double .combo-symbols span {
    width: 40px;
    height: 40px;
    font-size: 22px;
}

.win-combination {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    transition: all 0.3s;
    border: 1px solid rgba(255, 255, 255, 0.05);
}

.win-combination:hover {
    background: rgba(255, 255, 255, 0.1);
    transform: translateX(5px);
    border-color: rgba(255, 215, 0, 0.2);
}

.combo-symbols {
    display: flex;
    gap: 10px;
    align-items: center;
}

.combo-symbols span {
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 45px;
    height: 45px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 10px;
    transition: transform 0.2s;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.combo-symbols span:hover {
    transform: scale(1.1);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.2);
}

.combo-prize {
    font-weight: bold;
    color: gold;
    font-size: 16px;
    display: flex;
    align-items: center;
    gap: 5px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
.stats-info {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 25px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    font-size: 15px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s;
}

.stat-item:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateX(3px);
}

.stat-item i {
    color: #00d2ff;
    width: 20px;
    text-align: center;
    font-size: 16px;
}

.stat-item span:last-child {
    font-weight: bold;
    color: gold;
    margin-left: auto;
}

/* –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É */
.bottom-nav {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: calc(100% - 40px);
    max-width: 480px;
    background: rgba(20, 20, 35, 0.95);
    border-radius: 20px;
    padding: 12px;
    margin: 0;
    z-index: 100;
    box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.5);
    border: 2px solid rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
}

/* –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –æ—Ç—Å—Ç—É–ø –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
.main-content {
    margin-bottom: 100px;
    padding-bottom: 20px;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
@media (max-width: 480px) {
    .bottom-nav {
        bottom: 10px;
        width: calc(100% - 20px);
        padding: 10px;
    }
    
    .main-content {
        margin-bottom: 90px;
    }
}

/* –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –≤—ã–∏–≥—Ä—ã—à–µ–π */
.win-combination {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    background: linear-gradient(90deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%);
    border-radius: 12px;
    margin-bottom: 8px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    transition: all 0.3s ease;
}

.win-combination:hover {
    transform: translateX(5px);
    background: linear-gradient(90deg, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 100%);
    border-color: rgba(255, 215, 0, 0.3);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.combo-symbols {
    display: flex;
    gap: 10px;
    align-items: center;
}

.combo-symbols span {
    font-size: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 50px;
    height: 50px;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 12px;
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}

.combo-symbols span:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
}

.combo-prize {
    font-weight: bold;
    color: gold;
    font-size: 18px;
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(255, 215, 0, 0.1);
    padding: 8px 16px;
    border-radius: 25px;
    border: 1px solid rgba(255, 215, 0, 0.3);
}

.wins-table-double .combo-symbols span {
    width: 45px;
    height: 45px;
    font-size: 24px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
.stats-info {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-top: 25px;
    padding: 20px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.stat-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    font-size: 16px;
    border: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s;
}

.stat-item:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: translateY(-2px);
    border-color: rgba(0, 123, 255, 0.3);
    box-shadow: 0 5px 15px rgba(0, 123, 255, 0.1);
}

.stat-item i {
    color: #00d2ff;
    font-size: 18px;
    width: 30px;
    text-align: center;
}

.stat-item span:first-child {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-grow: 1;
}

.stat-item span:last-child {
    font-weight: bold;
    color: gold;
    font-size: 18px;
    min-width: 60px;
    text-align: right;
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.stat-item:hover i {
    animation: pulse 1s infinite;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 480px) {
    .win-combination {
        padding: 12px;
    }
    
    .combo-symbols span {
        width: 40px;
        height: 40px;
        font-size: 22px;
    }
    
    .combo-prize {
        font-size: 16px;
        padding: 6px 12px;
    }
    
    .wins-table-double .combo-symbols span {
        width: 35px;
        height: 35px;
        font-size: 20px;
    }
    
    .stat-item {
        padding: 12px;
        font-size: 14px;
    }
    
    .stat-item span:last-child {
        font-size: 16px;
    }
}
//////////////////////////////////////////////////////////////////////////////




wallet.html:
//////////////////////////////////////////////////////////////////////////////
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—á–µ—Ç–∞ - Emoji Slots</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
       
        <header class="header">
            <div class="balance-container">
                <div class="balance">
                    <i class="fas fa-star"></i>
                    <span id="balance">0</span>
                </div>
                <div class="balance coins-balance">
                    <i class="fas fa-coins"></i>
                    <span id="coins">0</span>
                </div>
            </div>
            
            <div class="logo">
                <h1><span class="logo-gradient">üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</span></h1>
                <p class="subtitle">–ü–æ–ø–æ–ª–Ω–∏ —Å—á–µ—Ç Telegram Stars –∏–ª–∏ TON</p>
            </div>
            
            <div class="stats">
                <div class="stat">
                    <i class="fas fa-exchange-alt"></i>
                </div>
            </div>
        </header>

        <main class="main-content">
            <div class="wallet-container">
                <div class="wallet-section">
                    <h3><i class="fas fa-star"></i> Telegram Stars</h3>
                    <p class="section-description">–ü–æ–ø–æ–ª–Ω–∏—Ç–µ —Å—á–µ—Ç –∑–≤—ë–∑–¥–∞–º–∏ —á–µ—Ä–µ–∑ Telegram</p>
                    
                    <div class="stars-packs">
                        <div class="pack-card" data-stars="50">
                            <div class="pack-icon">‚≠ê</div>
                            <div class="pack-info">
                                <h4>50 Stars</h4>
                                <p class="pack-price">~0.5 USD</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                        
                        <div class="pack-card" data-stars="100">
                            <div class="pack-icon">‚≠ê</div>
                            <div class="pack-info">
                                <h4>100 Stars</h4>
                                <p class="pack-price">~1 USD</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                        
                        <div class="pack-card" data-stars="500">
                            <div class="pack-icon">‚≠ê‚≠ê‚≠ê</div>
                            <div class="pack-info">
                                <h4>500 Stars</h4>
                                <p class="pack-price">~5 USD</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                    </div>
                    
                    <div class="payment-info">
                        <p><i class="fas fa-info-circle"></i> –ó–≤—ë–∑–¥—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∏–≥—Ä–æ–≤—É—é –≤–∞–ª—é—Ç—É 1:1</p>
                    </div>
                </div>
                
                <div class="wallet-section">
                    <h3><i class="fas fa-coins"></i> TON –ö–æ—à–µ–ª–µ–∫</h3>
                    <p class="section-description">–ü–æ–¥–∫–ª—é—á–∏—Ç–µ TON –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –º–æ–Ω–µ—Ç</p>
                    
                    <div class="ton-connect" id="tonConnect">
                        <div class="ton-info">
                            <div class="ton-icon">üíé</div>
                            <div class="ton-details">
                                <h4>–ü–æ–¥–∫–ª—é—á–∏—Ç—å TON –∫–æ—à–µ–ª–µ–∫</h4>
                                <p>–ö—É–ø–∏—Ç–µ –º–æ–Ω–µ—Ç—ã –∑–∞ TON</p>
                            </div>
                        </div>
                        <button class="btn-connect" id="connectWallet">
                            <i class="fas fa-plug"></i>
                            –ü–æ–¥–∫–ª—é—á–∏—Ç—å
                        </button>
                    </div>
                    
                    <div class="coins-packs" id="coinsPacks" style="display: none;">
                        <h4>–ü–∞–∫–µ—Ç—ã –º–æ–Ω–µ—Ç</h4>
                        <div class="pack-card" data-coins="10">
                            <div class="pack-icon">ü™ô</div>
                            <div class="pack-info">
                                <h4>10 –ú–æ–Ω–µ—Ç</h4>
                                <p class="pack-price">~0.1 TON</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                        
                        <div class="pack-card" data-coins="50">
                            <div class="pack-icon">ü™ôü™ô</div>
                            <div class="pack-info">
                                <h4>50 –ú–æ–Ω–µ—Ç</h4>
                                <p class="pack-price">~0.5 TON</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                        
                        <div class="pack-card" data-coins="100">
                            <div class="pack-icon">ü™ôü™ôü™ô</div>
                            <div class="pack-info">
                                <h4>100 –ú–æ–Ω–µ—Ç</h4>
                                <p class="pack-price">~1 TON</p>
                            </div>
                            <button class="btn-buy">–ö—É–ø–∏—Ç—å</button>
                        </div>
                    </div>
                </div>
                
                <div class="instructions">
                    <h4><i class="fas fa-question-circle"></i> –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</h4>
                    <p>1. <strong>Telegram Stars</strong> - –ø–æ–∫—É–ø–∞–π—Ç–µ –ø—Ä—è–º–æ –≤ Telegram, –∑–≤—ë–∑–¥—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è</p>
                    <p>2. <strong>TON –ö–æ—à–µ–ª–µ–∫</strong> - –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –º–æ–Ω–µ—Ç</p>
                    <p>3. –ú–æ–Ω–µ—Ç—ã –Ω—É–∂–Ω—ã –¥–ª—è –ø–æ–∫—É–ø–∫–∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö –ø–æ–¥–∞—Ä–∫–æ–≤ –≤ –º–∞–≥–∞–∑–∏–Ω–µ</p>
                    <p class="note">üí° –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã Telegram –∏ TON</p>
                </div>
            </div>
        </main>
        
        <div class="notification" id="notification">
            <span id="notificationText"></span>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É -->
<nav class="navbar bottom-nav">
    <a href="index.html" class="nav-item">
        <i class="fas fa-dice"></i>
        <span>–°–ª–æ—Ç—ã</span>
    </a>
    <a href="shop.html" class="nav-item ">
        <i class="fas fa-shopping-bag"></i>
        <span>–ú–∞–≥–∞–∑–∏–Ω</span>
    </a>
    <a href="wallet.html" class="nav-item active">
        <i class="fas fa-wallet"></i>
        <span>–ü–æ–ø–æ–ª–Ω–∏—Ç—å</span>
    </a>
    <a href="profile.html" class="nav-item">
        <i class="fas fa-user"></i>
        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
    </a>
</nav>

    </div>
    
    <!-- TON Connect SDK -->
    <script src="https://unpkg.com/@tonconnect/ui@latest/dist/tonconnect-ui.min.js"></script>
    <script src="api.js"></script>
    <script src="wallet.js"></script>
</body>
</html>
//////////////////////////////////////////////////////////////////////////////




wallet.js:
/////////////////////////////////////////////////////////////////////////////
// wallet.js
const elements = {
    balance: document.getElementById('balance'),
    coins: document.getElementById('coins'),
    connectWallet: document.getElementById('connectWallet'),
    coinsPacks: document.getElementById('coinsPacks'),
    notification: document.getElementById('notification'),
    notificationText: document.getElementById('notificationText')
};

// –î–ª—è TON Connect
let tonConnectUI = null;

async function init() {
    await loadUserData();
    setupEventListeners();
    initTONConnect();
}

async function loadUserData() {
    const user = Api.getCurrentUser();
    if (user) {
        updateUIFromUser(user);
    }
}

function updateUIFromUser(user) {
    if (elements.balance) elements.balance.textContent = user.balance || 0;
    if (elements.coins) elements.coins.textContent = user.coins || 0;
}

function initTONConnect() {
    try {
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TON Connect UI
        tonConnectUI = new TON_CONNECT_UI.TonConnectUI({
            manifestUrl: 'https://your-app.com/tonconnect-manifest.json',
            buttonRootId: 'connectWallet'
        });
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
        tonConnectUI.connectionRestored.then((connected) => {
            if (connected) {
                elements.coinsPacks.style.display = 'block';
                elements.connectWallet.style.display = 'none';
            }
        });
        
    } catch (error) {
        console.log('TON Connect –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω:', error);
    }
}

function setupEventListeners() {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤ Stars
    document.querySelectorAll('.pack-card[data-stars]').forEach(card => {
        card.querySelector('.btn-buy').addEventListener('click', () => {
            const stars = parseInt(card.dataset.stars);
            buyStars(stars);
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–∞–∫–µ—Ç–æ–≤ Coins (–ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è TON)
    document.addEventListener('click', (e) => {
        if (e.target.classList.contains('btn-buy')) {
            const card = e.target.closest('.pack-card[data-coins]');
            if (card) {
                const coins = parseInt(card.dataset.coins);
                buyCoins(coins);
            }
        }
    });
    
    // –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —á–µ—Ä–µ–∑ Telegram Stars
    if (elements.connectWallet) {
        elements.connectWallet.addEventListener('click', () => {
            showNotification('–§—É–Ω–∫—Ü–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ TON –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–∑–∂–µ', 3000);
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ—à–µ–ª—å–∫–∞
            elements.coinsPacks.style.display = 'block';
            elements.connectWallet.style.display = 'none';
        });
    }
}

// –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ –∑–≤—ë–∑–¥ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ Telegram Stars API)
async function buyStars(amount) {
    const user = Api.getCurrentUser();
    if (!user) return;
    
    try {
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –≤—ã–∑–æ–≤ Telegram Stars API
        // –°–µ–π—á–∞—Å –∏–º–∏—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –ø–æ–∫—É–ø–∫—É
        await Api.updateBalance(user.id, amount, 0);
        
        showNotification(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω–æ ${amount} –∑–≤—ë–∑–¥!`, 3000);
        updateUIFromUser(Api.getCurrentUser());
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ', 2000);
    }
}

// –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ –º–æ–Ω–µ—Ç (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ TON)
async function buyCoins(amount) {
    const user = Api.getCurrentUser();
    if (!user) return;
    
    try {
        // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è TON
        // –°–µ–π—á–∞—Å –∏–º–∏—Ç–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—É—é –ø–æ–∫—É–ø–∫—É
        await Api.updateBalance(user.id, 0, amount);
        
        showNotification(`‚úÖ –£—Å–ø–µ—à–Ω–æ –∫—É–ø–ª–µ–Ω–æ ${amount} –º–æ–Ω–µ—Ç!`, 3000);
        updateUIFromUser(Api.getCurrentUser());
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏:', error);
        showNotification('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ', 2000);
    }
}

function showNotification(message, duration = 3000) {
    elements.notificationText.textContent = message;
    elements.notification.classList.add('show');
    
    setTimeout(() => {
        elements.notification.classList.remove('show');
    }, duration);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
} else {
    init();
}
///////////////////////////////////////////////////////////////////////////







                               apptg:
    /////////////////////////////////////////////////////////////////////////////



    package.json:
    /////////////////////////////////////////////////////////////////////////////////
    {
  "name": "telegram-slots",
  "version": "1.0.0",
  "scripts": {
    "build": "echo 'No build required'"
  },
  "dependencies": {
    "@supabase/supabase-js": "^2.38.4"
  }
}
    //////////////////////////////////////////////////////////////////////////////////




    netlify.toml:
    ///////////////////////////////////////////////////////////////////////////////////
    [build]
  publish = "public"
  functions = "netlify/functions"

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
    ///////////////////////////////////////////////////////////////////////////////////

